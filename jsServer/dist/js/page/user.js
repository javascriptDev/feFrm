define(function(require){function t(t){O.find("[data-tab]").hide(),D.find(".on").removeClass("on").addClass("out"),D.find('[data-tab="'+t+'"]').addClass("on").removeClass("out"),O.find('[data-tab="'+t+'"]').show(),M.attr("data-show","1")}var n=require("js/lib/template"),o=require("js/component/pull"),a=require("js/component/carousel"),s=require("js/component/waterfull"),c=require("js/component/lazyload"),d=require("js/component/share"),l=require("js/tools/client"),h=require("js/component/util"),f=require("js/component/page");require("js/lib/rem");var p,m=0,g=n.compile(list),v=n.compile(carousel),w=n.compile(catgory_tpl),y=$(".list-c"),x=($(".bottom"),$(".goods_title")),b=$(".fixed"),T=($(".mask"),$(".sort_alt")),k=$(".filter_area"),S=$(".filter"),L=($("body"),$(".sort")),C=x.find(".sort"),j=x.find(".filter"),I=(b.find(".sort"),b.find(".filter"),20),P=$(".banner .inner"),A=$(".business-text"),E=(x.height(),$("#position")),M=$(".layer-in"),D=M.find(".tab"),H=$(".sorttext"),O=$(".tab-c"),W=$(".nofind"),F=($(".rtop "),$(".filter_box")),B=$(".loading-mask"),_=$(".top-c"),N=$(".hot-cgy"),Q=($(".search_box"),$(".category_box")),U=$(".category-text"),R=$(".category_box"),z=$(".category_box div"),V=(R[0],$(".search-txt"),$(".service")),Y=l.getUid()||"",G="",J=function(){var t=[];return{getData:function(n){for(var i=0,o=t.length;o>i;i++)if(t[i].productId==n)return t[i]},add:function(n){"[object Array]"==Object.prototype.toString.call(n)&&(t=t.concat(n))},empty:function(){t.length=0}}}(),X=function(){var t=[];return{getData:function(n){for(var i=0,o=t.length;o>i;i++)if(t[i].id==n)return t[i]},add:function(n){"[object Array]"==Object.prototype.toString.call(n)&&(t=t.concat(n))},empty:function(){t.length=0}}}();h.injectCss();var K=d.resultUrl,Z=d.searchUrl,tt={commissionRateSort:"",comprehensiveSort:"",highPriceFilter:"",lowPriceFilter:"",shopFilter:"",categoryId:"",userId:Y,ppvid:G,page:f.main},et=d.mainApi,it=d.carsouselApi,nt=d.hotCategory,ot=d.searchCategoryApi,rt=d.hotSearchWord,at=document.querySelector(".wf-indicator"),st=new s({url:et,indicator:at,params:{test:!0,pageNum:1,pageSize:I},page:1,target:y,success:function(t,n,o){if(n&&n.data){var a=n.data.productList;if(!tt.ppvid&&(tt.ppvid=n.data.ppvid),B.hide(),!a||0==a.length)return void(o?(this.destroy(),B.hide()):(y.html(""),this.die(),B.hide()));W.hide(),y.append(g({list:a,fixed:function(t,n){return parseFloat(t).toFixed("undefined"==typeof n?2:n)},text:function(t){return 1==t?ymVar.jsServer+"images/logo_tianmao.png":ymVar.jsServer+"images/logo_tianmao.png"},floor:function(t,n){return(t/n*10).toFixed(1)},jsserver:function(){return ymVar.jsServer}})),J.add(a)}else y.html(""),W.show(),B.hide()},addition:45,before:function(){this.params.pageNum=this.page,$.extend(this.params,tt)},needFirst:1});at.style.display="none";var ct=(new o({url:et,indicator:document.querySelector(".loader"),target:y,params:{test:!0,pageNum:1,pageSize:I},y:0,target:document.querySelector(".main"),success:function(t,n){if(st.reLive(),W.hide(),n&&n.data&&n.data.productList){tt.ppvid&&(tt.ppvid=n.data.ppvid),B.hide(),window.scrollTo(0,0);var o=($(".list-c .list_box"),n.data.productList);J.empty();var a=g({list:o,fixed:function(t,n){return parseFloat(t).toFixed("undefined"==typeof n?2:n)},text:function(t){return 1==t?ymVar.jsServer+"images/logo_tianmao.png":ymVar.jsServer+"images/logo_tianmao.png"},floor:function(t,n){return(t/n*10).toFixed(1)},jsserver:function(){return ymVar.jsServer}});J.empty(),J.add(o),y.html(""),y.append(a)}else W.show(),B.hide(),window.onscroll=null},before:function(){$.extend(this.params,tt)},done:function(){_.css("top","-40px")},moveStart:function(t){_.css("top",-40+t+"px")},maxOperation:function(){},needFirst:0}),document.getElementsByClassName("rtop")),dt=window.innerHeight,lt=window.onscroll;window.onscroll=function(){"function"==typeof lt&&lt(),document.body.scrollTop>=dt?ct[0].style.opacity=1:ct[0].style.opacity=0},new c({main:document.querySelector(".list-c"),selector:".list_left img"}),$.get(it,function(t){t=JSON.parse(t),renderData=t.data.carouselList,count=renderData.length,X.add(renderData);var n=v({carousel:renderData});P.html(n);for(var n='<li class="cur"></li>',i=0;i<count-1;i++)n+="<li></li>";var o=P.children()[0].offsetWidth;$(".banner").css("height",o/3.1+"px"),new a({target:P[0],timeout:3e3,count:count,itemWidth:o,indicator:document.querySelector("#position"),notRun:0,end:function(){}}),E.html(n)}),$.get(nt,function(t){if(t=JSON.parse(t),t&&t.data&&t.data.categoryOrKeyHot){var n=w({catgory:t.data.categoryOrKeyHot});N.html(n)}});var ut=document.documentElement.clientHeight-m;M.find(".tab-c").height(ut),$.get(rt,function(t){if(t=JSON.parse(t),t&&t.data&&t.data.categoryOrKeyHot){var n=t.data.categoryOrKeyHot.sort(function(t,n){return t.weight<n.weight})[0];window.gotoSearch=function(){var u=Z+"?h5_from_page=main&h5_kw="+h.delSpace(n.name||"")+"&"+n.link;try{window.pushView(u,"1")}catch(e){window.search.pushView(u,"1")}}}}),$.get(ot,function(t){if(t=JSON.parse(t),t&&t.data){var n=t.data.topCategoryList||[],o="";$.each(n,function(t,n){o+='<a data-type="'+n.id+'" data-key="categoryFilter"><div style="width:100%;position:static;">'+n.name+"</div></a>"}),z.append(o)}else console.log("ajax error")}),!function(){function n(e){e.stopPropagation(),l.showBar();var t=e.target.className;(-1!=t.indexOf("sort_alt")||-1!=t.indexOf("filter_area")||-1!=t.indexOf("layer-toggle"))&&M.hide()}C.click(function(e){e.stopPropagation(),t(1),M.show(),l.hideBar()}),j.click(function(e){e.stopPropagation(),t(2),M.show(),p=M.find("[data-key].on"),l.hideBar()}),M.delegate(".tab [data-tab]","click",function(e){e.stopPropagation();var n=$(this);return n.hasClass("on")&&"block"==$(".layer-in").css("display")?(l.showBar(),M.hide(),M.find("[data-key].on").removeClass("on"),p&&!p.hasClass("on")&&p.addClass("on"),void(p&&p.each(function(t,n){$($(".red_font")[t]).text($(n).text())}))):void t(n.attr("data-tab"))}),T.delegate("li","click",function(e){l.showBar(),e.stopPropagation();var t=$(this);return t.hasClass("on")?void M.hide():(tt.comprehensiveSort=t.find("a").attr("data-type"),window.scrollTo(0,0),T.find(".on").removeClass("on"),t.addClass("on"),H.html(t.text()),L.addClass("on").removeClass("out"),M.hide(),b.hide(),x.show(),st.reLive(),B.show(),document.querySelector(".wf-indicator").style.display="none",void st.rebuild(function(t){y.html(""),t&&t.data&&t.data.productList?0==t.data.productList.length&&(W.show(),J.empty()):W.show(),document.querySelector(".wf-indicator").style.display="none"}))});var o=($("[data-key]"),$("[data-root]"),$(".business"));$(".filter_reset").click(function(e){e.stopPropagation(),l.showBar(),location.reload()}),o.delegate("[data-type]","click",function(){var t=$(this);if(t.hasClass("on")){var n=$(o.children()[0]);t.removeClass("on"),n.addClass("on"),A.text(n.text())}else o.find(".on").removeClass("on"),t.addClass("on"),A.text(t.text())}),V.delegate("[data-type]","click",function(){var t=$(this);t.hasClass("on")?t.removeClass("on"):(V.find(".on").removeClass("on"),t.addClass("on"))}),Q.delegate("[data-type]","click",function(){var t=$(this);if(t.hasClass("on")){var n=$(z.children()[0]);t.removeClass("on"),n.addClass("on"),U.text(n.text())}else Q.find(".on").removeClass("on"),t.addClass("on"),U.text(t.text())}),$(".filter_submit").click(function(e){l.showBar(),e.stopPropagation();var t=1,n={};k.find("[data-key]").each(function(o){var a=$(this),s=a.attr("reg"),c=parseFloat(a.val()),d=a.attr("data-key"),l=a.attr("than"),h=a.attr("error"),f=a.attr("thanError");return 0>=c?($("."+d+"-err").text(h).show(),t=0,void setTimeout(function(){$("."+d+"-err").hide()},1500)):!s||isNaN(c)||new RegExp(s).test(c)?l&&parseInt($('[data-key="'+l+'"]').val())>c?($("."+d+"-err").text(f).show(),t=0,void setTimeout(function(){$("."+d+"-err").hide()},1500)):void(!n[d]&&(n[d]=c||a.hasClass("on")&&a.attr("data-type")||"")):($("."+d+"-err").text(h).show(),t=0,void setTimeout(function(){$("."+d+"-err").hide()},1500))}),t&&(tt=n,window.scrollTo(0,0),M.hide(),S.addClass("on").removeClass("out"),x.show(),st.reLive(),W.hide(),B.show(),document.querySelector(".wf-indicator").style.display="none",st.rebuild(function(t){t&&t.data&&t.data.productList?0==t.data.productList.length&&(W.show(),J.empty()):W.show(),y.html(""),document.querySelector(".wf-indicator").style.display="none"}))}),y.delegate("[data-link]","click",function(e){var t=$(this),n=t.attr("data-share"),o=t.attr("data-id"),a=J.getData(o);if(n){var s=JSON.stringify({shareType:"0",linkUrl:a.targetUrl,itemId:o});l.share(s)}else{var c=1==a.shopType?"淘宝":"天猫",s=JSON.stringify({discountPrice:a.discountPrice,returnPrice:a.returnPrice,targetUrl:a.targetUrl,itemId:o,fromPage:"page_goods",shopName:c,type:0,shareType:"0",shopLogo:a.shopLogo,page:f.main,isCollection:a.collection});l.gotoPage(s)}}),T.on("touchmove",function(e){e.stopPropagation(),e.preventDefault()}),k.on("touchmove",function(e){e.stopPropagation(),e.preventDefault()});var a=0,s=0;F.on("touchstart",function(e){e.stopPropagation(),a=e.touches[0].clientY,s=parseInt(F.css("top"))}),F.on("touchmove",function(e){e.stopPropagation(),e.preventDefault();var t=s+e.touches[0].clientY-a;t>0||ut-F.height()>0||t<ut-F.height()-350||F.css("top",t+"px")}),$(".layer-toggle").click(n),P.delegate("[data-carousel]","click",function(){var t=$(this).attr("data-id"),n=X.getData(t),o=n.type,a="/activityList.html?topicId="+n.id;2==o&&(a=n.linkUrl),l.gotoPage(JSON.stringify({id:n.id,itemId:n.id,name:n.name,linkUrl:a,type:1,specialType:o,page:f.businessTopic}))}),N.delegate("[data-click]","click",function(t){var n=h.delSpace(encodeURI($(this).attr("data-link"))),o=h.delSpace(encodeURI($(this).find(".cate-name").text())),u=K+"?searchType=2&h5_from_page=main&h5_kw="+o+"&"+n;try{window.pushView(u,"0")}catch(e){window.search.pushView(u,"0")}})}()}),!function(){function t(t){return t.replace(y,"").replace(u,",").replace(x,"").replace($,"").replace(b,"").split(T)}function n(t){return"'"+t.replace(/('|\\)/g,"\\$1").replace(/\r/g,"\\r").replace(/\n/g,"\\n")+"'"}function o(o,a){function e(t){return p+=t.split(/\n/).length-1,h&&(t=t.replace(/\s+/g," ").replace(/<!--[\w\W]*?-->/g,"")),t&&(t=w[1]+n(t)+w[2]+"\n"),t}function s(n){var o=p;if(l?n=l(n,a):c&&(n=n.replace(/\n/g,function(){return p++,"$line="+p+";"})),0===n.indexOf("=")){var e=f&&!/^=[=#]/.test(n);if(n=n.replace(/^=[=#]?|[\s;]*$/g,""),e){var s=n.replace(/\s*\([^\)]+\)/,"");m[s]||/^(include|print)$/.test(s)||(n="$escape("+n+")")}else n="$string("+n+")";n=w[1]+n+w[2]}return c&&(n="$line="+o+";"+n),r(t(n),function(t){if(t&&!v[t]){var n;n="print"===t?u:"include"===t?x:m[t]?"$utils."+t:g[t]?"$helpers."+t:"$data."+t,$+=t+"="+n+",",v[t]=!0}}),n+"\n"}var c=a.debug,d=a.openTag,i=a.closeTag,l=a.parser,h=a.compress,f=a.escape,p=1,v={$data:1,$filename:1,$utils:1,$helpers:1,$out:1,$line:1},q="".trim,w=q?["$out='';","$out+=",";","$out"]:["$out=[];","$out.push(",");","$out.join('')"],y=q?"$out+=text;return $out;":"$out.push(text);",u="function(){var text=''.concat.apply('',arguments);"+y+"}",x="function(filename,data){data=data||$data;var text=$utils.$include(filename,data,$filename);"+y+"}",$="'use strict';var $utils=this,$helpers=$utils.$helpers,"+(c?"$line=0,":""),b=w[0],T="return new String("+w[3]+");";r(o.split(d),function(t){t=t.split(i);var n=t[0],o=t[1];1===t.length?b+=e(n):(b+=s(n),o&&(b+=e(o)))});var k=$+b+T;c&&(k="try{"+k+"}catch(e){throw {filename:$filename,name:'Render Error',message:e.message,line:$line,source:"+n(o)+".split(/\\n/)[$line-1].replace(/^\\s+/,'')};}");try{var S=new Function("$data","$filename",k);return S.prototype=m,S}catch(L){throw L.temp="function anonymous($data,$filename) {"+k+"}",L}}var a=function(t,n){return"string"==typeof n?q(n,{filename:t}):c(t,n)};a.version="3.0.0",a.config=function(t,n){e[t]=n};var e=a.defaults={openTag:"<%",closeTag:"%>",escape:!0,cache:!0,compress:!1,parser:null},s=a.cache={};a.render=function(t,n){return q(t,n)};var c=a.renderFile=function(t,n){var o=a.get(t)||v({filename:t,name:"Render Error",message:"Template not found"});return n?o(n):o};a.get=function(t){var n;if(s[t])n=s[t];else if("object"==typeof document){var o=document.getElementById(t);if(o){var a=(o.value||o.innerHTML).replace(/^\s*|\s*$/g,"");n=q(a,{filename:t})}}return n};var d=function(t,n){return"string"!=typeof t&&(n=typeof t,"number"===n?t+="":t="function"===n?d(t.call(t)):""),t},i={"<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","&":"&#38;"},l=function(t){return i[t]},h=function(t){return d(t).replace(/&(?![\w#]+;)|[<>"']/g,l)},f=Array.isArray||function(t){return"[object Array]"==={}.toString.call(t)},p=function(t,n){var o,a;if(f(t))for(o=0,a=t.length;a>o;o++)n.call(t,t[o],o,t);else for(o in t)n.call(t,t[o],o)},m=a.utils={$helpers:{},$include:c,$string:d,$escape:h,$each:p};a.helper=function(t,n){g[t]=n};var g=a.helpers=m.$helpers;a.onerror=function(t){var n="Template Error\n\n";for(var o in t)n+="<"+o+">\n"+t[o]+"\n\n";"object"==typeof console&&console.error(n)};var v=function(t){return a.onerror(t),function(){return"{Template Error}"}},q=a.compile=function(t,n){function a(o){try{return new i(o,d)+""}catch(a){return n.debug?v(a)():(n.debug=!0,q(t,n)(o))}}n=n||{};for(var c in e)void 0===n[c]&&(n[c]=e[c]);var d=n.filename;try{var i=o(t,n)}catch(l){return l.filename=d||"anonymous",l.name="Syntax Error",v(l)}return a.prototype=i.prototype,a.toString=function(){return i.toString()},d&&n.cache&&(s[d]=a),a},r=m.$each,w="break,case,catch,continue,debugger,default,delete,do,else,false,finally,for,function,if,in,instanceof,new,null,return,switch,this,throw,true,try,typeof,var,void,while,with,abstract,boolean,byte,char,class,const,double,enum,export,extends,final,float,goto,implements,import,int,interface,long,native,package,private,protected,public,short,static,super,synchronized,throws,transient,volatile,arguments,let,yield,undefined",y=/\/\*[\w\W]*?\*\/|\/\/[^\n]*\n|\/\/[^\n]*$|"(?:[^"\\]|\\[\w\W])*"|'(?:[^'\\]|\\[\w\W])*'|\s*\.\s*[$\w\.]+/g,u=/[^\w$]+/g,x=new RegExp(["\\b"+w.replace(/,/g,"\\b|\\b")+"\\b"].join("|"),"g"),$=/^\d[^,]*|,\d[^,]*/g,b=/^,+|,+$/g,T=/^$|,+/;"function"==typeof define?define("js/lib/template",function(require,t,n){n.exports=a}):"undefined"!=typeof exports?module.exports=a:this.template=a}(),define("js/component/pull",function(require,t,n){function o(t){this.lock=0,this.success=t.success,this.indicator=t.indicator,this.normalText=t.normalText||"下拉刷新数据.",this.LoadingText=t.LoadingText||"加载中...",this.limitText=t.limitText||"松手加载数据!",this.LoadedText=t.LoadedText||"加载完毕",this.target=t.target,this.timeout=t.timeout||5e3,this.limit=this.indicator.offsetHeight+(t.addition||0),this.max=200,this.url=t.url,this.params=t.params,this.status=s.Normal,this.page=1,this.inited=0,this.beginY=t.y,this.before=t.before,this.moveStart=t.moveStart,this.needFirst=t.needFirst,this.done=t.done,this.maxOperation=t.maxOperation,this.timeoutHandler=void 0,this.loadError="加载失败!",this.init()}var a=require("js/component/lazyload"),s={Normal:-1,BeforeLoad:0,Loading:1,Loaded:2,Done:3},c=document.body;n.exports=o,o.prototype={init:function(){var t=this.indicator.style;t.backgroundSize="100% 100%",this.addEvent(),this.needFirst&&this.fetch()},addEvent:function(){var t=0,n=this.target,o=this;n.addEventListener("touchstart",function(e){t=e.touches[0].clientY}),n.addEventListener("touchmove",function(e){if(0==c.scrollTop&&!o.lock&&!window.lock){var n=e.touches[0].clientY;if(!(t>n&&o.status==s.Normal)){e.preventDefault();var a=(n-t)/o.max;if(!(a>1)){var d=60*(1-Math.pow(1-a,2));d<o.limit?(o.setIndicatorText(o.normalText),o.moveStart&&o.moveStart(d),o.status=s.Normal):d>o.limit&&(o.maxOperation&&o.maxOperation(),o.status=s.BeforeLoad,o.setIndicatorText(o.limitText)),o.moveStart&&o.moveStart(d),o.setTargetPos(o.beginY+d)}}}}),n.addEventListener("touchend",function(e){return o.lock?void 0:o.status==s.BeforeLoad?(o.lock=1,void o.statusMachine(s.BeforeLoad)):void o.statusMachine(s.Done,1)})},fetch:function(){this.before&&this.before.call(this);var t=this;this.timeoutHandler=setTimeout(function(){t.timeoutHandler&&t.reset(t.loadError)},this.timeout),t.params.pageNum=t.page,t.statusMachine(s.Loading),$.ajax({url:t.url,data:t.params,success:function(n){t.statusMachine(s.Loaded,n)},error:function(n){t.statusMachine(s.Loaded,"ajax error")},dataType:"json"})},statusMachine:function(t,n){var o=this;switch(t){case s.BeforeLoad:this.fetch();break;case s.Loading:this.setIndicatorText(this.LoadingText);break;case s.Loaded:if(o.timeoutHandler=void 0,this.status==s.Normal)return;this.setIndicatorText(this.LoadedText),"string"==typeof n?this.success(n):this.success(void 0,n),a.prototype.renderImage(o.target,".list_left img"),o.statusMachine(s.Done);break;case s.Done:;this.reset(void 0,n)}},reset:function(t,n){var o=this;this.lock=0,this.status=s.Normal,t&&this.setIndicatorText(t),setTimeout(function(){o.setTargetPos(o.beginY),o.done&&o.done(),o.setIndicatorText(o.normalText)},n||500)},setIndicatorText:function(t){return this.indicator.innerText!=t&&(this.indicator.innerText=t),this},setTargetPos:function(t){return this.target.style.marginTop=t+"px",this}}}),define("js/component/carousel",function(require,t,n){function o(t){this.lock=0,this.index=0,this.itemWidth=t.itemWidth||document.documentElement.clientWidth,this.limit=.3*this.itemWidth,this.target=t.target,this.max=t.count-1,this.timeout=t.timeout,this.indicator=t.indicator,this.timeHandler=void 0,this.basePosition=0,this.end=t.end,this.notRun=t.notRun,this.els=this.target.querySelectorAll("[data-carousel]"),this.init()}n.exports=o,o.prototype={init:function(){this.target.style.width=100*(this.max+1)+"%",$(this.target).find("[data-carousel]").css("width",100/(this.max+1)+"%"),!this.notRun&&this.run(),this.addEvent(),this.set3D(),this.fixPos()},set3D:function(t){var n=this.target;["webkitTransition","transition"].forEach(function(o){n.style[o]="left "+(t?0:.3)+"s"})},addEvent:function(){var t=this.target,n=this,o=0,a=0;t.addEventListener("touchstart",function(e){if(!n.lock){var t=e.touches[0];o=t.clientX,a=t.clientY,n.basePosition=parseInt(n.target.style.left),clearInterval(n.timeHandler),n.set3D(1)}}),t.addEventListener("touchmove",function(e){if(!n.lock){var t=e.touches[0],s=t.clientX,c=t.clientY,d=Math.abs(s-o),l=Math.abs(c-a);if(Math.atan(d/l)/Math.PI*360>45){window.lock=1,!n.isCarouselMove&&(n.isCarouselMove=1),e.preventDefault();var h=s-o;h>0?n.right(h):n.left(h)}else n.isCarouselMove&&e.preventDefault()}}),t.addEventListener("touchend",function(e){window.lock=0,n.set3D(),n.reset(),n.lock=0,n.end&&n.end(),!n.notRun&&n.run()})},run:function(){var t=this;this.timeHandler=setInterval(function(){t.index++,t.reset(),t.set3D(),t.fixPos()},this.timeout)},go:function(t){this.target.style.left=this.basePosition+t+"px"},move:function(t,n){Math.abs(t)>=this.limit?(this.lock=1,"left"==n?this.index++:this.index--,this.set3D(),this.reset(),this.fixPos()):this.go(t)},left:function(t){this.move(t,"left")},right:function(t){this.move(t,"right")},fixPos:function(){var t=this.index,n=this.max+1,o=(t%n-1)%n,a=(t%n+1)%n;0>o&&(o+=n),0>a&&(a+=n),t==this.max?a=0:0==t&&(o=this.max),this.els[o].style.transform="translateX("+((this.index-1)*this.itemWidth-this.els[o].offsetLeft)+"px)",this.els[o].style.webkitTransform="translateX("+((this.index-1)*this.itemWidth-this.els[o].offsetLeft)+"px)",this.els[a].style.webkitTransform="translateX("+((this.index+1)*this.itemWidth-this.els[a].offsetLeft)+"px)",this.els[a].style.transform="translateX("+((this.index+1)*this.itemWidth-this.els[a].offsetLeft)+"px)"},reset:function(){this.target.style.left=-this.index*this.itemWidth+"px",$(".cur").removeClass("cur");var t=this.index%(this.max+1);0>t&&(t+=this.max+1),this.indicator.children[t].className+=" cur",this.isCarouselMove=0}}}),define("js/component/waterfull",function(require,t,n){function o(t){this.url=t.url,this.lock=0,this.page=t.page||2,this.params=t.params||{},this.needFirst=t.needFirst,this.before=t.before,this.indicator=t.indicator,this.success=t.success,this.target=t.target,this.needDestroy=1,this.ignore=0,this.addition=t.addition,this.scrollTest=d,this.inited=0,this.timeout=t.timeout||4e3,this.timeoutHandler=void 0,this.img=t.img||".list_left img",this.init(),this.needFirst&&this.fetch()}function a(){var t=this,n=window.onscroll,o=this.indicator.style;o.backgroundSize="100% 100%",window.onscroll=function(){"function"==typeof n&&n(),t.scrollTest&&t.scrollTest()}}function s(){this.scrollTest=void 0}function c(t){1==this.isdestroy&&(this.scrollTest=d,this.isdestroy=0,!t&&this.init(),this.lock=0,this.indicator.innerHTML="Loading...")}function d(){var t=this;if(!t.lock)return t.ignore?void(t.ignore=0):void(window.scrollY>=w.offsetHeight-y-t.addition&&(t.lock=1,t.fetch()))}function l(){this.scrollTest=void 0,this.indicator.style.backgroundImage='url("aaa")',this.indicator.innerHTML="没有数据了..",this.indicator.style.textIndent="0",this.isdestroy=1,this.inited=0}function h(){this.indicator.style.display="block"}function f(t){this.timeoutHandler=void 0,this.success&&("string"==typeof t?this.success(t,this.inited):this.success(void 0,t,this.inited)),this.lock=0,this.isdestroy||(v.prototype.renderImage(this.target,this.img),this.indicator.style.display="none",!this.inited&&(this.inited=1))}function p(t){var n=this;this.before&&this.before.call(this);var n=this;this.timeoutHandler=setTimeout(function(){},this.timeout),this.loading(),$.ajax({url:n.url,data:n.params,success:function(o){"function"==typeof t&&t.call(n,o),n.loaded(o),!n.isdestroy&&n.page++},error:function(t){n.loaded("ajax error")},dataType:"json"})}function m(t,n){this.page=1,this.inited=0,n&&this.reLive(!0),this.fetch(t),this.ignore=1}function g(){this.page++,this.lock=1,this.fetch()}var v=require("js/component/lazyload"),w=document.body,y=document.documentElement.clientHeight;n.exports=o,o.prototype={init:a,fetch:p,loading:h,loaded:f,rebuild:m,destroy:l,reLive:c,die:s,nextPage:g}}),define("js/component/lazyload",function(require,t,n){function o(t){this.main=t.main,this.selecotr=t.selecotr,this.init()}var a=(document.body,document.documentElement.clientHeight);n.exports=o,o.prototype={init:function(){var t=this,n=window.onscroll;window.onscroll=function(){"function"==typeof n&&n(),t.renderImage()}},renderImage:function(t,n){var o=this.main||t||document.body;$(o).find(n||this.selecotr||"img").each(function(){var t=$(this);if(t[0].getBoundingClientRect().top<a&&!t.attr("init")){var n=t.attr("csrc");n&&t.attr("src",n).attr("init",1)}})}}}),define("js/component/share",function(require,t,n){var o="http://172.16.40.215:8080",a="/ol.html",s="/result.html",c="/search.html",d="/pl.html",l="/shareRecord.html",h="/queqiao/account/getOrderList",f="/queqiao/account/getUserAccountInfo",p="/queqiao/performance/getSummaryInfo",m=o+"/queqiao/log/saveClickLog",g=o+"/queqiao/log/saveBrowseLog",v=o+"/queqiao/collectionShare/clickCollectionShareUrl",w="/product/getProductInfoQQiaoShare",y="/tdj/getTaodianjinInfo",x="/queqiao/order/getNewOrderNum",$="/product/getQQiaoSolrProductList",b=o+"/product/getTopCategoryList?test=true",T=o+"/product/getQueQiaoProductList?test=true&pageNum=1&pageSize=20",k=o+"/product/getQueQiaoProductList",S=o+"/product/getQueQiaoCarouselList?test=true",L=o+"/product/getQueQiaoCategoryHot?test=true&type=2",C=o+"/product/getQueQiaoCategoryHot?test=true&type=1",j=o+"/topic/getTopicInfoQueQiaoShare",I=o+"/topic/getTopicInfoQueQiao",P=o+"/queqiao/share/getShareList",A=o+"/queqiao/performance/getPerformanceList";n.exports={server:o,resultUrl:s,searchUrl:c,prPage:d,srPage:l,sc:v,searchCategoryApi:b,recommendApi:T,mainApi:k,carsouselApi:S,hotSearchWord:L,hotCategory:C,appActivityAPI:I,activityApi:j,clickApi:m,browseApi:g,olUrl:function(t){return a+(t||"")},searchResultApi:function(){return o+$},olApi:function(t){return o+h+(t||"")+"&test=true"},balanceApi:function(t){return o+f+"?userId="+t+"&test=true"},yjApi:function(t,n,a){return o+p+"?beginTime="+(t||"")+"&endTime="+(n||"")+"&userId="+(a||"")+"&test=true"},pdApi:function(t){return o+w+"?productId="+t+"&test=true"},tdjApi:function(t){return o+y+"?NumIids="+t+"&test=true"},newOlApi:function(t,n){return o+x+"?userId="+t+"&lastTime="+n+"&test=true"},shareRecordApi:function(t){return P+"?test=true&userId="+t},plApi:function(t){return A+"?test=true&userId="+t}}}),define("js/tools/client",function(require,t,n){function o(){try{window.common.showHideGoodsBar(1)}catch(e){window.showHideGoodsBar&&window.showHideGoodsBar(1)}}function a(){try{window.common.showHideGoodsBar(0)}catch(e){window.showHideGoodsBar&&window.showHideGoodsBar(0)}}function s(){try{window.common.hideBlackView()}catch(e){window.hideBlackView&&window.hideBlackView()}}function c(){try{window.common.showWarn()}catch(e){window.showWarn&&window.showWarn()}}function d(){try{window.common.hideWarn()}catch(e){window.hideWarn&&window.hideWarn()}}function l(t,n){try{window.common.shipOrderDetail("",t,n)}catch(e){window.shipOrderDetail&&window.shipOrderDetail(t,n)}}function h(){try{window.common.shipWallet()}catch(e){window.shipWallet&&window.shipWallet()}}function f(t){try{return window.common.getUser()}catch(e){return window.getUid&&window.getUid()}}function p(){try{window.common.gotoMain()}catch(e){window.gotoMain&&window.gotoMain()}}function m(t){try{window.common.shareInfo(t)}catch(e){window.shareInfo&&window.shareInfo(t)}}function g(t){console.log(t);try{window.shop.shopPage(t)}catch(e){window.carouselRedirect&&window.carouselRedirect(t)}}function v(t,n,o){try{window.common.newWebPage(t,n||"0",o||0)}catch(e){window.newPage&&window.newPage(t,n||"0",o)}}n.exports={share:m,gotoPage:g,getUid:f,gotoDetail:l,newPage:v,shipWallet:h,gotoMain:p,showWarn:c,hideWarn:d,hideLayer:s,hideBar:o,showBar:a}}),define("js/component/util",function(require,t,n){function o(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var r=16*Math.random()|0,n="x"==t?r:3&r|8;return n.toString(16)})}function a(){var t=document.documentElement.clientWidth,n=document.createElement("style");n.innerHTML=".rtop{background-size:100% 100% !important;}.list_top .list_left{height:"+.36*t+"px;max-height:"+.36*t+"px;overflow:hidden;}",document.getElementsByTagName("head")[0].appendChild(n)}function s(){var t=new Date;return[t.getFullYear(),"-",t.getMonth()+1,"-",t.getDate()," ",t.getHours(),":",t.getMinutes(),":",t.getSeconds()].map(function(t){return"number"==typeof t&&10>t?"0"+t:t})}function c(){var t=new Date;return[t.getFullYear(),t.getMonth()+1,t.getDate()]}function d(t){return t.replace(/(^\s*)|(\s*$)/g,"").replace(/[\r\n]/g,"")}function l(){return!!navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)}function h(){var u=navigator.userAgent;return u.indexOf("Android")>-1||u.indexOf("Linux")>-1}function f(){var t=navigator.userAgent.toLowerCase();return"micromessenger"==t.match(/MicroMessenger/i)?!0:!1}function p(t){return"string"!=typeof t?{}:(t=$.trim(t).replace(/^(\?|#|&)/,""),t?t.split("&").reduce(function(t,n){var o=n.replace(/\+/g," ").split("="),a=o[0],s=o[1];return a=decodeURIComponent(a),s=void 0===s?null:decodeURIComponent(s),t.hasOwnProperty(a)?Array.isArray(t[a])?t[a].push(s):t[a]=[t[a],s]:t[a]=s,t},{}):{})}function m(){var t=window.navigator.userAgent.toLowerCase(),n="8";return"micromessenger"==t.match(/MicroMessenger/i)?n="4":"qqbrowser"==t.match(/QQBrowser/i)||"mqqbrowser"==t.match(/MQQBrowser/i)||"qq"==t.match(/QQ/i)?n="5":"weibo"==t.match(/Weibo/i)?n="2":"alipay"==t.match(/Alipay/i)&&(n="7"),n}n.exports={urlParse:p,getChannelType:m,isWeixin:f,isIos:l,isAndroid:h,delSpace:d,getDate:c,Guid:o,getTime:s,injectCss:a}}),define("js/component/page",function(require,t,n){n.exports={main:1,search:2,sysTopic:3,businessTopic:4,businessDetail:5,otherApp:6,single:7,tdj:8,sysTopicShare:9,businessTopicShare:10,other:11}}),define("js/lib/rem",function(require,t,n){n.exports=!function(t,n){function o(){var n=c.getBoundingClientRect().width;n/h>540&&(n=540*h);var e=n/10;c.style.fontSize=e+"px",p.rem=t.rem=e}var a,s=t.document,c=s.documentElement,d=s.querySelector('meta[name="viewport"]'),l=s.querySelector('meta[name="flexible"]'),h=0,f=0,p=n.flexible||(n.flexible={});if(d){var m=d.getAttribute("content").match(/initial\-scale=([\d\.]+)/);m&&(f=parseFloat(m[1]),h=parseInt(1/f))}else if(l){var g=l.getAttribute("content");if(g){var v=g.match(/initial\-dpr=([\d\.]+)/),w=g.match(/maximum\-dpr=([\d\.]+)/);v&&(h=parseFloat(v[1]),f=parseFloat((1/h).toFixed(2))),w&&(h=parseFloat(w[1]),f=parseFloat((1/h).toFixed(2)))}}if(!h&&!f){var u=(t.navigator.appVersion.match(/android/gi),t.navigator.appVersion.match(/iphone/gi)),y=t.devicePixelRatio;h=u?y>=3&&(!h||h>=3)?3:y>=2&&(!h||h>=2)?2:1:1,f=1/h}if(c.setAttribute("data-dpr",h),!d)if(d=s.createElement("meta"),d.setAttribute("name","viewport"),d.setAttribute("content","initial-scale="+f+", maximum-scale="+f+", minimum-scale="+f+", user-scalable=no"),c.firstElementChild)c.firstElementChild.appendChild(d);else{var x=s.createElement("div");x.appendChild(d),s.write(x.innerHTML)}t.addEventListener("resize",function(){clearTimeout(a),a=setTimeout(o,300)},!1),t.addEventListener("pageshow",function(t){t.persisted&&(clearTimeout(a),a=setTimeout(o,300))},!1),"complete"===s.readyState?s.body.style.fontSize=12*h+"px":s.addEventListener("DOMContentLoaded",function(){s.body.style.fontSize=12*h+"px"},!1),o(),p.dpr=t.dpr=h,p.refreshRem=o,p.rem2px=function(t){var n=parseFloat(t)*this.rem;return"string"==typeof t&&t.match(/rem$/)&&(n+="px"),n},p.px2rem=function(t){var n=parseFloat(t)/this.rem;return"string"==typeof t&&t.match(/px$/)&&(n+="rem"),n}}(window,{})});