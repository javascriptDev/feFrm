define(function(require){var t=require("js/component/calendar"),n=(require("js/component/util"),require("js/tools/date"),document.querySelector(".date-get")),a=n.querySelector(".date-get-inner"),s=new t({height:150,max:[2015,12,1],title:"开始日期",container:a}),o=new t({height:150,max:[2015,12,1],cls:"date2",title:"结束日期",container:a});$ok.click(function(){console.log(s.getVal()),console.log(o.getVal()),n.style.left="100%"}),window.show=function(){n.style.left="0"},window.hide=function(){n.style.left="100%"}}),define("js/component/calendar",function(require,t,n){function a(t){t=t||{},this.initDate=t.current,this.parent=t.container,this.yearStamp=t.yearStamp||30,this.height=t.height||150,this.itemHeight=t.itemHeight||30,this.year=[],this.month=[1,2,3,4,5,6,7,8,9,10,11,12],this.day=[],this.max=t.max,this.addCls=t.cls||"",this.title=t.title,this.end=t.end,this.init()}function s(){var t=this.title?"<div class='"+this.addCls+"'><div class=date-title>"+this.title+"</div>":"";t+="<div class='date-cmp'><div class='rule1'></div><div class='rule2'></div><div class='rule3'></div><div class='title'></div><div class='date-body'><div class='year'><div data-tp='year' class='inner'></div></div><div class='month'><div data-tp='month' class='inner'></div></div><div class='day'><div data-tp='day' class='inner'></div></div></div><div class='toolbar'><div class='ok'>确定</div><div class='today'>今天</div><div class='cancel'>取消</div></div></div>";var n=".date-title{width:100%;text-align:center;color:#ddd;height:30px;line-height:30px;}*{padding:0;margin:0}.date-cmp{width:80%;margin:0 10%;border:1px solid #ccc;position:relative;font-weight:700}.title{width:100%;height:30px;line-height:30px;text-align:center;color:red;border-bottom:2px solid #f43f48;color:#f43f48}.date-body{position:relative;height:150px;width:100%;-webkit-box-shadow:inset 0 14px 11px 0 rgba(255,255,255,0.6);-moz-box-shadow:inset 0 14px 11px 0 rgba(255,255,255,0.6);box-shadow:inset 0 14px 11px 0 rgba(255,255,255,0.6)}.rule1,.rule2,.rule3{position:absolute;top:90px;border-bottom:2px solid #f43f48;border-top:2px solid #f43f48;width:18%;height:30px}.rule1{left:7%}.rule2{left:40%}.rule3{left:73%}.date-body>div{width:33.33%;float:left;height:100%;position:relative;overflow:hidden}.inner{position:absolute;top:0;width:100%;transition:.0s top;-webkit-transition:.0s top;will-change:transform;transform:translateZ(0);-webkit-transform:translateZ(0)}.inner>div{text-align:center;width:100%;height:30px;line-height:30px}.toolbar{height:30px;border-top:1px solid #ccc;color:#555;font-size:13px}.toolbar div{border-right:1px solid #ccc;width:32.7999%;text-align:center;display:inline-block;line-height:30px;height:28px}.toolbar div:last-child{border:0}";this.title&&(t+="</div>");var a=$(t,{position:"relative"});f.inject(n),this.el=a,this.yearEl=a.find(".year .inner"),this.monthEl=a.find(".month .inner"),this.dayEl=a.find(".day .inner"),this.$body=a.find(".date-body"),this.titleEl=a.find(".title"),this.toolbar=a.find(".toolbar")}function o(){var t=new Date;return[t.getFullYear(),t.getMonth()+1,t.getDate()]}function h(t){var n=parseInt(t[0]),a=parseInt(t[1]),s=void 0;return s=-1!=[1,3,5,7,8,10,12].indexOf(a)?31:-1!=[4,6,8,9,11].indexOf(a)?30:n%4==0&&n%100!=0||n%100==0&&n%400==0?29:28}function d(t,n,a){var s=t/n;return a>0?Math.ceil(s)*n:Math.floor(s)*n}function l(){return Math.abs(parseInt(this.dayEl.css("top")||0)/this.itemHeight-3)}function c(){return Math.abs(parseInt(this.monthEl.css("top")||0)/this.itemHeight-3)}function p(){return this.year[Math.abs(parseInt(this.yearEl.css("top")||0)/this.itemHeight-2)]}var f=(require("js/component/util"),require("js/component/EventEmitter"),require("js/tools/css"));n.exports=a,a.prototype={init:function(){s.call(this);var t=o();this.setAll(t);var n=this.itemHeight;this.max&&(this.yearMax=(2-this.year.indexOf(this.max[0]))*n,this.monthMax=(2-this.month.indexOf(this.max[1]))*n,this.dayMax=(2-this.day.indexOf(this.max[2]))*n),this.addEvent(),this.render(),this.setPos(t)},setYear:function(t){var n=t[0],a="";this.year=[];for(var s,i=n-this.yearStamp;i<n+this.yearStamp;i++)a+="<div>"+i+"</div>",this.year.push(i),i==n&&(s=this.year.length-1);this.yearEl.html(a),a=void 0,n=void 0},setMonth:function(t){this.monthEl.html(this.month.map(function(t){return"<div>"+t+"</div>"}).join(""))},setDay:function(t,n){this.day.length=0;for(var a=h(t),s="",i=1;a>=i;i++)s+="<div>"+i+"</div>",this.day.push(i);this.dayEl.html(s),s=void 0,day=void 0},setAll:function(t){this.setYear(t),this.setMonth(t),this.setDay(t)},setPos:function(t){var n=this.itemHeight,a=(2*this.itemHeight,parseInt(t[0])),s=parseInt(t[1]),o=this.yearEl,h=this.monthEl,d=this.dayEl,l=(2-this.year.indexOf(a))*n,c=(2-this.month.indexOf(s))*n,p=this.day[parseInt(t[2])]?t[2]:this.day.length,p=-(p-3)*n;this.move(o,l).move(h,c).move(d,p).setVal()},addEvent:function(){var t,n,a=this,s=this.itemHeight,h=this.$body,l="",c="";h.delegate(".inner","touchstart",function(e){e.preventDefault();var a=$(this);t=parseFloat(a.css("top")),c=a.attr("data-tp"),n=e.touches[0].clientY}).delegate(".inner","touchmove",function(e){e.preventDefault();var s=e.touches[0].clientY,o=s-n+t;a.move($(this),o),l=s>n?1:-1}).delegate(".inner","touchend",function(e){a.end&&a.end(),e.preventDefault();var t=$(this),n=parseFloat(t.css("top"));if(a.move(t,d(n,s,l)),"day"==c)return void a.setVal();var o=a.getVal();a.setDay(o,parseInt(a.dayEl.css("top"))),a.setPos(o)}).delegate(".inner div","click",function(e){}),this.toolbar.delegate("div","click",function(e){var t=$(this),n=t.attr("class");switch(n){case"ok":alert(a.getVal().join("-"));break;case"cancel":alert("cancel");break;case"today":a.setPos(o());break;default:return}})},render:function(){(this.parent||document.body).appendChild(this.el[0])},move:function(t,n){var a=this.itemHeight,s=2*a;if(n>s||this.height-t.height()>n+s)return this;var o=this.max;if(o){var h=t.attr("data-tp");"day"==h?n<this.dayMax&&c.call(this)==o[1]&&(n=this.dayMax):"year"==h?n<this.yearMax&&(n=this.yearMax):n<this.monthMax&&(n=this.monthMax)}return t.css("top",n),this},getVal:function(){var t=(this.itemHeight,p.call(this)),n=c.call(this),a=l.call(this);return n=10>n?"0"+n:n,a=10>a?"0"+a:a,[t,n,a]},setVal:function(){this.titleEl.text(this.getVal().join("-"))}}}),define("js/component/util",function(require,t,n){function a(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var r=16*Math.random()|0,n="x"==t?r:3&r|8;return n.toString(16)})}function s(){var t=document.documentElement.clientWidth,n=document.createElement("style");n.innerHTML=".rtop{background-size:100% 100% !important;}.list_top .list_left{height:"+.36*t+"px;max-height:"+.36*t+"px;overflow:hidden;}",document.getElementsByTagName("head")[0].appendChild(n)}function o(){var t=new Date;return[t.getFullYear(),"-",t.getMonth()+1,"-",t.getDate()," ",t.getHours(),":",t.getMinutes(),":",t.getSeconds()].map(function(t){return"number"==typeof t&&10>t?"0"+t:t})}function h(){var t=new Date;return[t.getFullYear(),t.getMonth()+1,t.getDate()]}function d(t){return t.replace(/(^\s*)|(\s*$)/g,"").replace(/[\r\n]/g,"")}function l(){return!!navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)}function c(){var u=navigator.userAgent;return u.indexOf("Android")>-1||u.indexOf("Linux")>-1}function p(){var t=navigator.userAgent.toLowerCase();return"micromessenger"==t.match(/MicroMessenger/i)?!0:!1}function f(t){return"string"!=typeof t?{}:(t=$.trim(t).replace(/^(\?|#|&)/,""),t?t.split("&").reduce(function(t,n){var a=n.replace(/\+/g," ").split("="),s=a[0],o=a[1];return s=decodeURIComponent(s),o=void 0===o?null:decodeURIComponent(o),t.hasOwnProperty(s)?Array.isArray(t[s])?t[s].push(o):t[s]=[t[s],o]:t[s]=o,t},{}):{})}function v(){var t=window.navigator.userAgent.toLowerCase(),n="8";return"micromessenger"==t.match(/MicroMessenger/i)?n="4":"qqbrowser"==t.match(/QQBrowser/i)||"mqqbrowser"==t.match(/MQQBrowser/i)||"qq"==t.match(/QQ/i)?n="5":"weibo"==t.match(/Weibo/i)?n="2":"alipay"==t.match(/Alipay/i)&&(n="7"),n}n.exports={urlParse:f,getChannelType:v,isWeixin:p,isIos:l,isAndroid:c,delSpace:d,getDate:h,Guid:a,getTime:o,injectCss:s}}),define("js/tools/date",function(req,t,n){function a(t,n){var a=t[0],s=t[1],o=t[2],h=0;return 1>o+n?(s--,0>=s&&(s+=12,a--),-1!=[1,3,5,7,8,10,12].indexOf(s)?h=31:-1!=[4,6,8,9,11].indexOf(s)?h=30:a%4==0&&a%100!=0||a%100==0&&a%400==0&&(h=29)||(h=28),o=h+o+n):o+=n,10>s&&(s="0"+s),10>o&&(o="0"+o),[a,s,o]}n.exports={getEndDate:a}}),define("js/component/EventEmitter",function(require,t,n){return function(){var t={};return{on:function(n,a,s){return!t[n]&&(t[n]=[]),s&&!s.__id&&(s.__id=Math.random()),t[n].push({fn:a,context:s}),this},emit:function(n,a,s){return t[n]&&t[n].forEach(function(t,n){if(s){if(t.context.__id==s.__id)return void t.fn.apply(s,a)}else t.fn.apply(t.context||null,a)}),this}}}()}),define("js/tools/css",function(req,t,n){function a(t){var n=document.createElement("style");n.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(n)}n.exports={inject:a}});